{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Список книг</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="{%url 'favorite_list' %}">Избраные книги</a>

    <div class="collapse navbar-collapse justify-content-end">
      {% if user.is_authenticated %}
        <span class="navbar-text me-3">
          {{ user.email }}
        </span>
        <a href="{% url 'logout' %}" class="btn btn-outline-light btn-sm">Выйти</a>
      {% else %}
        <a href="{% url 'login' %}" class="btn btn-outline-light btn-sm me-2">Вход</a>
        <a href="{% url 'register' %}" class="btn btn-success btn-sm">Регистрация</a>
      {% endif %}
    </div>
  </div>
</nav>

<div class="container mt-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Список книг</h1>

        {% if user.is_authenticated and user.is_admin %}
            <div>
                <a href="{% url 'book_add' %}" class="btn btn-primary btn-sm">Добавить книгу</a>
                <a href="{% url 'export_books_csv' %}" class="btn btn-secondary btn-sm">CSV</a>
            </div>
        {% endif %}
    </div>

    <div class="row">
        {% for book in books %}
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ book.title }}</h5>

                        <p class="card-text text-muted">
                            {{ book.description|truncatewords:20 }}
                        </p>

                        <div class="mt-auto">
                            <a href="{% url 'book_detail' book.pk %}" class="btn btn-outline-primary btn-sm">
                                Подробнее
                            </a>

                            {% if user.is_authenticated and user.is_admin %}
                                <a href="{% url 'book_delete' book.pk %}"
                                   class="btn btn-outline-danger btn-sm">
                                   Удалить
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        {% empty %}
            <p>Книг пока нет.</p>
        {% endfor %}
    </div>

</div>

</body>
</html>

